{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport * as i1 from '@spartacus/core';\nimport { PageType, ComponentDecorator, SlotDecorator } from '@spartacus/core';\nimport { filter, take } from 'rxjs/operators';\nimport * as i2 from '@spartacus/smartedit/root';\nclass SmartEditService {\n  constructor(cmsService, routingService, baseSiteService, zone, winRef, rendererFactory, config, scriptLoader) {\n    this.cmsService = cmsService;\n    this.routingService = routingService;\n    this.baseSiteService = baseSiteService;\n    this.zone = zone;\n    this.winRef = winRef;\n    this.rendererFactory = rendererFactory;\n    this.config = config;\n    this.scriptLoader = scriptLoader;\n    this.isPreviewPage = false;\n    // load webApplicationInjector.js first\n    this.loadScript();\n    if (winRef.nativeWindow) {\n      const window = winRef.nativeWindow;\n      // rerender components and slots after editing\n      window.smartedit = window.smartedit || {};\n      window.smartedit.renderComponent = (componentId, componentType, parentId) => {\n        return this.renderComponent(componentId, componentType, parentId);\n      };\n      // reprocess page\n      window.smartedit.reprocessPage = this.reprocessPage;\n    }\n  }\n  processCmsPage() {\n    this.baseSiteService.get().pipe(filter(site => Boolean(site)), take(1)).subscribe(site => {\n      this.defaultPreviewCategoryCode = site.defaultPreviewCategoryCode;\n      this.defaultPreviewProductCode = site.defaultPreviewProductCode;\n      this.cmsService.getCurrentPage().pipe(filter(Boolean)).subscribe(cmsPage => {\n        this._currentPageId = cmsPage.pageId;\n        // before adding contract to page, we need redirect to that page\n        this.goToPreviewPage(cmsPage);\n        this.addPageContract(cmsPage);\n      });\n    });\n  }\n  /**\n   * load webApplicationInjector.js\n   */\n  loadScript() {\n    var _a;\n    this.scriptLoader.embedScript({\n      src: 'assets/webApplicationInjector.js',\n      params: undefined,\n      attributes: {\n        id: 'text/smartedit-injector',\n        'data-smartedit-allow-origin': (_a = this.config.smartEdit) === null || _a === void 0 ? void 0 : _a.allowOrigin\n      }\n    });\n  }\n  /**\n   * add CSS classes in a body tag\n   */\n  addPageContract(cmsPage) {\n    const renderer = this.rendererFactory.createRenderer('body', null);\n    const element = this.winRef.document.body;\n    // remove old page contract\n    const previousContract = [];\n    Array.from(element.classList).forEach(attr => previousContract.push(attr));\n    previousContract.forEach(attr => renderer.removeClass(element, attr));\n    // add new page contract\n    this.addSmartEditContract(element, renderer, cmsPage.properties);\n  }\n  /**\n   * go to the default preview page\n   */\n  goToPreviewPage(cmsPage) {\n    // only the first page is the smartedit preview page\n    if (!this.isPreviewPage) {\n      this.isPreviewPage = true;\n      if (cmsPage.type === PageType.PRODUCT_PAGE && this.defaultPreviewProductCode) {\n        this.routingService.go({\n          cxRoute: 'product',\n          params: {\n            code: this.defaultPreviewProductCode,\n            name: ''\n          }\n        });\n      } else if (cmsPage.type === PageType.CATEGORY_PAGE && this.defaultPreviewCategoryCode) {\n        this.routingService.go({\n          cxRoute: 'category',\n          params: {\n            code: this.defaultPreviewCategoryCode\n          }\n        });\n      }\n    }\n  }\n  /**\n   * re-render CMS components and slots\n   */\n  renderComponent(componentId, componentType, parentId) {\n    if (componentId) {\n      this.zone.run(() => {\n        // without parentId, it is slot\n        if (!parentId) {\n          if (this._currentPageId) {\n            this.cmsService.refreshPageById(this._currentPageId);\n          } else {\n            this.cmsService.refreshLatestPage();\n          }\n        } else if (componentType) {\n          this.cmsService.refreshComponent(componentId);\n        }\n      });\n    }\n    return true;\n  }\n  reprocessPage() {\n    // TODO: reprocess page API\n  }\n  /**\n   * add smartedit HTML markup contract\n   */\n  addSmartEditContract(element, renderer, properties) {\n    if (properties) {\n      // check each group of properties, e.g. smartedit\n      Object.keys(properties).forEach(group => {\n        const name = 'data-' + group + '-';\n        const groupProps = properties[group];\n        // check each property in the group\n        Object.keys(groupProps).forEach(propName => {\n          const propValue = groupProps[propName];\n          if (propName === 'classes') {\n            const classes = propValue.split(' ');\n            classes.forEach(classItem => {\n              renderer.addClass(element, classItem);\n            });\n          } else {\n            renderer.setAttribute(element, name + propName.split(/(?=[A-Z])/).join('-').toLowerCase(), propValue);\n          }\n        });\n      });\n    }\n  }\n}\nSmartEditService.ɵfac = function SmartEditService_Factory(t) {\n  return new (t || SmartEditService)(i0.ɵɵinject(i1.CmsService), i0.ɵɵinject(i1.RoutingService), i0.ɵɵinject(i1.BaseSiteService), i0.ɵɵinject(i0.NgZone), i0.ɵɵinject(i1.WindowRef), i0.ɵɵinject(i0.RendererFactory2), i0.ɵɵinject(i2.SmartEditConfig), i0.ɵɵinject(i1.ScriptLoader));\n};\nSmartEditService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: SmartEditService,\n  factory: SmartEditService.ɵfac,\n  providedIn: 'root'\n});\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(SmartEditService, [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }], function () {\n    return [{\n      type: i1.CmsService\n    }, {\n      type: i1.RoutingService\n    }, {\n      type: i1.BaseSiteService\n    }, {\n      type: i0.NgZone\n    }, {\n      type: i1.WindowRef\n    }, {\n      type: i0.RendererFactory2\n    }, {\n      type: i2.SmartEditConfig\n    }, {\n      type: i1.ScriptLoader\n    }];\n  }, null);\n})();\nclass SmartEditComponentDecorator extends ComponentDecorator {\n  constructor(smartEditService) {\n    super();\n    this.smartEditService = smartEditService;\n  }\n  decorate(element, renderer, component) {\n    if (component) {\n      this.smartEditService.addSmartEditContract(element, renderer, component.properties);\n    }\n  }\n}\nSmartEditComponentDecorator.ɵfac = function SmartEditComponentDecorator_Factory(t) {\n  return new (t || SmartEditComponentDecorator)(i0.ɵɵinject(SmartEditService));\n};\nSmartEditComponentDecorator.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: SmartEditComponentDecorator,\n  factory: SmartEditComponentDecorator.ɵfac,\n  providedIn: 'root'\n});\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(SmartEditComponentDecorator, [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }], function () {\n    return [{\n      type: SmartEditService\n    }];\n  }, null);\n})();\nclass SmartEditSlotDecorator extends SlotDecorator {\n  constructor(smartEditService) {\n    super();\n    this.smartEditService = smartEditService;\n  }\n  decorate(element, renderer, slot) {\n    if (slot) {\n      this.smartEditService.addSmartEditContract(element, renderer, slot.properties);\n    }\n  }\n}\nSmartEditSlotDecorator.ɵfac = function SmartEditSlotDecorator_Factory(t) {\n  return new (t || SmartEditSlotDecorator)(i0.ɵɵinject(SmartEditService));\n};\nSmartEditSlotDecorator.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: SmartEditSlotDecorator,\n  factory: SmartEditSlotDecorator.ɵfac,\n  providedIn: 'root'\n});\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(SmartEditSlotDecorator, [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }], function () {\n    return [{\n      type: SmartEditService\n    }];\n  }, null);\n})();\nconst smartEditDecorators = [{\n  provide: ComponentDecorator,\n  useExisting: SmartEditComponentDecorator,\n  multi: true\n}, {\n  provide: SlotDecorator,\n  useExisting: SmartEditSlotDecorator,\n  multi: true\n}];\nclass SmartEditCoreModule {\n  constructor(smartEditService) {\n    this.smartEditService = smartEditService;\n    this.smartEditService.processCmsPage();\n  }\n}\nSmartEditCoreModule.ɵfac = function SmartEditCoreModule_Factory(t) {\n  return new (t || SmartEditCoreModule)(i0.ɵɵinject(SmartEditService));\n};\nSmartEditCoreModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: SmartEditCoreModule\n});\nSmartEditCoreModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  providers: [...smartEditDecorators]\n});\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(SmartEditCoreModule, [{\n    type: NgModule,\n    args: [{\n      providers: [...smartEditDecorators]\n    }]\n  }], function () {\n    return [{\n      type: SmartEditService\n    }];\n  }, null);\n})();\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { SmartEditCoreModule, SmartEditService };\n//# sourceMappingURL=spartacus-smartedit-core.js.map","map":{"version":3,"names":["i0","Injectable","NgModule","i1","PageType","ComponentDecorator","SlotDecorator","filter","take","i2","SmartEditService","constructor","cmsService","routingService","baseSiteService","zone","winRef","rendererFactory","config","scriptLoader","isPreviewPage","loadScript","nativeWindow","window","smartedit","renderComponent","componentId","componentType","parentId","reprocessPage","processCmsPage","get","pipe","site","Boolean","subscribe","defaultPreviewCategoryCode","defaultPreviewProductCode","getCurrentPage","cmsPage","_currentPageId","pageId","goToPreviewPage","addPageContract","_a","embedScript","src","params","undefined","attributes","id","smartEdit","allowOrigin","renderer","createRenderer","element","document","body","previousContract","Array","from","classList","forEach","attr","push","removeClass","addSmartEditContract","properties","type","PRODUCT_PAGE","go","cxRoute","code","name","CATEGORY_PAGE","run","refreshPageById","refreshLatestPage","refreshComponent","Object","keys","group","groupProps","propName","propValue","classes","split","classItem","addClass","setAttribute","join","toLowerCase","ɵfac","SmartEditService_Factory","t","ɵɵinject","CmsService","RoutingService","BaseSiteService","NgZone","WindowRef","RendererFactory2","SmartEditConfig","ScriptLoader","ɵprov","ɵɵdefineInjectable","token","factory","providedIn","ngDevMode","ɵsetClassMetadata","args","SmartEditComponentDecorator","smartEditService","decorate","component","SmartEditComponentDecorator_Factory","SmartEditSlotDecorator","slot","SmartEditSlotDecorator_Factory","smartEditDecorators","provide","useExisting","multi","SmartEditCoreModule","SmartEditCoreModule_Factory","ɵmod","ɵɵdefineNgModule","ɵinj","ɵɵdefineInjector","providers"],"sources":["D:/demo_spartacus/node_modules/@spartacus/smartedit/fesm2015/spartacus-smartedit-core.js"],"sourcesContent":["import * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport * as i1 from '@spartacus/core';\nimport { PageType, ComponentDecorator, SlotDecorator } from '@spartacus/core';\nimport { filter, take } from 'rxjs/operators';\nimport * as i2 from '@spartacus/smartedit/root';\n\nclass SmartEditService {\n    constructor(cmsService, routingService, baseSiteService, zone, winRef, rendererFactory, config, scriptLoader) {\n        this.cmsService = cmsService;\n        this.routingService = routingService;\n        this.baseSiteService = baseSiteService;\n        this.zone = zone;\n        this.winRef = winRef;\n        this.rendererFactory = rendererFactory;\n        this.config = config;\n        this.scriptLoader = scriptLoader;\n        this.isPreviewPage = false;\n        // load webApplicationInjector.js first\n        this.loadScript();\n        if (winRef.nativeWindow) {\n            const window = winRef.nativeWindow;\n            // rerender components and slots after editing\n            window.smartedit = window.smartedit || {};\n            window.smartedit.renderComponent = (componentId, componentType, parentId) => {\n                return this.renderComponent(componentId, componentType, parentId);\n            };\n            // reprocess page\n            window.smartedit.reprocessPage = this.reprocessPage;\n        }\n    }\n    processCmsPage() {\n        this.baseSiteService\n            .get()\n            .pipe(filter((site) => Boolean(site)), take(1))\n            .subscribe((site) => {\n            this.defaultPreviewCategoryCode = site.defaultPreviewCategoryCode;\n            this.defaultPreviewProductCode = site.defaultPreviewProductCode;\n            this.cmsService\n                .getCurrentPage()\n                .pipe(filter(Boolean))\n                .subscribe((cmsPage) => {\n                this._currentPageId = cmsPage.pageId;\n                // before adding contract to page, we need redirect to that page\n                this.goToPreviewPage(cmsPage);\n                this.addPageContract(cmsPage);\n            });\n        });\n    }\n    /**\n     * load webApplicationInjector.js\n     */\n    loadScript() {\n        var _a;\n        this.scriptLoader.embedScript({\n            src: 'assets/webApplicationInjector.js',\n            params: undefined,\n            attributes: {\n                id: 'text/smartedit-injector',\n                'data-smartedit-allow-origin': (_a = this.config.smartEdit) === null || _a === void 0 ? void 0 : _a.allowOrigin,\n            },\n        });\n    }\n    /**\n     * add CSS classes in a body tag\n     */\n    addPageContract(cmsPage) {\n        const renderer = this.rendererFactory.createRenderer('body', null);\n        const element = this.winRef.document.body;\n        // remove old page contract\n        const previousContract = [];\n        Array.from(element.classList).forEach((attr) => previousContract.push(attr));\n        previousContract.forEach((attr) => renderer.removeClass(element, attr));\n        // add new page contract\n        this.addSmartEditContract(element, renderer, cmsPage.properties);\n    }\n    /**\n     * go to the default preview page\n     */\n    goToPreviewPage(cmsPage) {\n        // only the first page is the smartedit preview page\n        if (!this.isPreviewPage) {\n            this.isPreviewPage = true;\n            if (cmsPage.type === PageType.PRODUCT_PAGE &&\n                this.defaultPreviewProductCode) {\n                this.routingService.go({\n                    cxRoute: 'product',\n                    params: { code: this.defaultPreviewProductCode, name: '' },\n                });\n            }\n            else if (cmsPage.type === PageType.CATEGORY_PAGE &&\n                this.defaultPreviewCategoryCode) {\n                this.routingService.go({\n                    cxRoute: 'category',\n                    params: { code: this.defaultPreviewCategoryCode },\n                });\n            }\n        }\n    }\n    /**\n     * re-render CMS components and slots\n     */\n    renderComponent(componentId, componentType, parentId) {\n        if (componentId) {\n            this.zone.run(() => {\n                // without parentId, it is slot\n                if (!parentId) {\n                    if (this._currentPageId) {\n                        this.cmsService.refreshPageById(this._currentPageId);\n                    }\n                    else {\n                        this.cmsService.refreshLatestPage();\n                    }\n                }\n                else if (componentType) {\n                    this.cmsService.refreshComponent(componentId);\n                }\n            });\n        }\n        return true;\n    }\n    reprocessPage() {\n        // TODO: reprocess page API\n    }\n    /**\n     * add smartedit HTML markup contract\n     */\n    addSmartEditContract(element, renderer, properties) {\n        if (properties) {\n            // check each group of properties, e.g. smartedit\n            Object.keys(properties).forEach((group) => {\n                const name = 'data-' + group + '-';\n                const groupProps = properties[group];\n                // check each property in the group\n                Object.keys(groupProps).forEach((propName) => {\n                    const propValue = groupProps[propName];\n                    if (propName === 'classes') {\n                        const classes = propValue.split(' ');\n                        classes.forEach((classItem) => {\n                            renderer.addClass(element, classItem);\n                        });\n                    }\n                    else {\n                        renderer.setAttribute(element, name +\n                            propName\n                                .split(/(?=[A-Z])/)\n                                .join('-')\n                                .toLowerCase(), propValue);\n                    }\n                });\n            });\n        }\n    }\n}\nSmartEditService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditService, deps: [{ token: i1.CmsService }, { token: i1.RoutingService }, { token: i1.BaseSiteService }, { token: i0.NgZone }, { token: i1.WindowRef }, { token: i0.RendererFactory2 }, { token: i2.SmartEditConfig }, { token: i1.ScriptLoader }], target: i0.ɵɵFactoryTarget.Injectable });\nSmartEditService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditService, providedIn: 'root' });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditService, decorators: [{\n            type: Injectable,\n            args: [{\n                    providedIn: 'root',\n                }]\n        }], ctorParameters: function () { return [{ type: i1.CmsService }, { type: i1.RoutingService }, { type: i1.BaseSiteService }, { type: i0.NgZone }, { type: i1.WindowRef }, { type: i0.RendererFactory2 }, { type: i2.SmartEditConfig }, { type: i1.ScriptLoader }]; } });\n\nclass SmartEditComponentDecorator extends ComponentDecorator {\n    constructor(smartEditService) {\n        super();\n        this.smartEditService = smartEditService;\n    }\n    decorate(element, renderer, component) {\n        if (component) {\n            this.smartEditService.addSmartEditContract(element, renderer, component.properties);\n        }\n    }\n}\nSmartEditComponentDecorator.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditComponentDecorator, deps: [{ token: SmartEditService }], target: i0.ɵɵFactoryTarget.Injectable });\nSmartEditComponentDecorator.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditComponentDecorator, providedIn: 'root' });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditComponentDecorator, decorators: [{\n            type: Injectable,\n            args: [{\n                    providedIn: 'root',\n                }]\n        }], ctorParameters: function () { return [{ type: SmartEditService }]; } });\n\nclass SmartEditSlotDecorator extends SlotDecorator {\n    constructor(smartEditService) {\n        super();\n        this.smartEditService = smartEditService;\n    }\n    decorate(element, renderer, slot) {\n        if (slot) {\n            this.smartEditService.addSmartEditContract(element, renderer, slot.properties);\n        }\n    }\n}\nSmartEditSlotDecorator.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditSlotDecorator, deps: [{ token: SmartEditService }], target: i0.ɵɵFactoryTarget.Injectable });\nSmartEditSlotDecorator.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditSlotDecorator, providedIn: 'root' });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditSlotDecorator, decorators: [{\n            type: Injectable,\n            args: [{\n                    providedIn: 'root',\n                }]\n        }], ctorParameters: function () { return [{ type: SmartEditService }]; } });\n\nconst smartEditDecorators = [\n    {\n        provide: ComponentDecorator,\n        useExisting: SmartEditComponentDecorator,\n        multi: true,\n    },\n    {\n        provide: SlotDecorator,\n        useExisting: SmartEditSlotDecorator,\n        multi: true,\n    },\n];\n\nclass SmartEditCoreModule {\n    constructor(smartEditService) {\n        this.smartEditService = smartEditService;\n        this.smartEditService.processCmsPage();\n    }\n}\nSmartEditCoreModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditCoreModule, deps: [{ token: SmartEditService }], target: i0.ɵɵFactoryTarget.NgModule });\nSmartEditCoreModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditCoreModule });\nSmartEditCoreModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditCoreModule, providers: [...smartEditDecorators] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: SmartEditCoreModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    providers: [...smartEditDecorators],\n                }]\n        }], ctorParameters: function () { return [{ type: SmartEditService }]; } });\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { SmartEditCoreModule, SmartEditService };\n//# sourceMappingURL=spartacus-smartedit-core.js.map\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}