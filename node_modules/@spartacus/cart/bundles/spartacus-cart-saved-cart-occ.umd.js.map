{"version":3,"file":"spartacus-cart-saved-cart-occ.umd.js","sources":["../../../feature-libs/cart/saved-cart/occ/adapters/occ-saved-cart.adapter.ts","../../../feature-libs/cart/saved-cart/occ/model/index.ts","../../../feature-libs/cart/saved-cart/occ/config/default-occ-saved-cart-config.ts","../../../feature-libs/cart/saved-cart/occ/saved-cart-occ.module.ts","../../../feature-libs/cart/saved-cart/occ/spartacus-cart-saved-cart-occ.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { SavedCartAdapter } from '@spartacus/cart/saved-cart/core';\nimport {\n  Cart,\n  CART_NORMALIZER,\n  ConverterService,\n  Occ,\n  OccEndpointsService,\n} from '@spartacus/core';\nimport { Observable } from 'rxjs';\nimport { map, pluck } from 'rxjs/operators';\n\n@Injectable()\nexport class OccSavedCartAdapter implements SavedCartAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(userId: string, cartId: string): Observable<Cart> {\n    return this.http\n      .get<Occ.Cart>(this.getSavedCartEndpoint(userId, cartId))\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  loadList(userId: string): Observable<Cart[]> {\n    return this.http\n      .get<Occ.CartList>(this.getSavedCartListEndpoint(userId))\n      .pipe(\n        pluck('carts'),\n        map((carts) => carts ?? []),\n        this.converter.pipeableMany(CART_NORMALIZER)\n      );\n  }\n\n  restoreSavedCart(userId: string, cartId: string): Observable<Cart> {\n    return this.http\n      .patch<Occ.Cart>(this.getRestoreSavedCartEndpoint(userId, cartId), cartId)\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  saveCart(\n    userId: string,\n    cartId: string,\n    saveCartName: string,\n    saveCartDescription: string\n  ): Observable<Cart> {\n    return this.http\n      .patch<Occ.Cart>(\n        this.getSaveCartEndpoint(\n          userId,\n          cartId,\n          saveCartName,\n          saveCartDescription\n        ),\n        cartId\n      )\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  cloneSavedCart(\n    userId: string,\n    cartId: string,\n    saveCartName: string\n  ): Observable<Cart> {\n    return this.http\n      .post<Occ.Cart>(\n        this.getCloneSavedCartEndpoint(userId, cartId, saveCartName),\n        cartId\n      )\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  protected getSavedCartEndpoint(userId: string, cartId: string): string {\n    return this.occEndpoints.buildUrl('savedCart', {\n      urlParams: { userId, cartId },\n    });\n  }\n\n  protected getSavedCartListEndpoint(userId: string): string {\n    return this.occEndpoints.buildUrl('savedCarts', { urlParams: { userId } });\n  }\n\n  protected getRestoreSavedCartEndpoint(\n    userId: string,\n    cartId: string\n  ): string {\n    return this.occEndpoints.buildUrl('restoreSavedCart', {\n      urlParams: { userId, cartId },\n    });\n  }\n\n  protected getSaveCartEndpoint(\n    userId: string,\n    cartId: string,\n    saveCartName: string,\n    saveCartDescription: string\n  ): string {\n    return this.occEndpoints.buildUrl('saveCart', {\n      urlParams: {\n        userId,\n        cartId,\n        saveCartName,\n        saveCartDescription,\n      },\n    });\n  }\n\n  protected getCloneSavedCartEndpoint(\n    userId: string,\n    cartId: string,\n    saveCartName: string\n  ): string {\n    return this.occEndpoints.buildUrl('cloneSavedCart', {\n      urlParams: { userId, cartId, saveCartName },\n    });\n  }\n}\n","// Imported for side effects (module augmentation)\nimport './occ-saved-cart-endpoints.model';\n","import { OccConfig } from '@spartacus/core';\n\nexport const defaultOccSavedCartConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        savedCarts:\n          '/users/${userId}/carts?savedCartsOnly=true&fields=carts(DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),saveTime,user,name,description)',\n        saveCart:\n          '/users/${userId}/carts/${cartId}/save?saveCartName=${saveCartName}&saveCartDescription=${saveCartDescription}',\n        savedCart: '/users/${userId}/carts/${cartId}/savedcart',\n        restoreSavedCart: '/users/${userId}/carts/${cartId}/restoresavedcart',\n        cloneSavedCart:\n          '/users/${userId}/carts/${cartId}/clonesavedcart?name=${saveCartName}',\n      },\n    },\n  },\n};\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { SavedCartAdapter } from '@spartacus/cart/saved-cart/core';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { OccSavedCartAdapter } from './adapters/occ-saved-cart.adapter';\nimport { defaultOccSavedCartConfig } from './config/default-occ-saved-cart-config';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccSavedCartConfig),\n    {\n      provide: SavedCartAdapter,\n      useClass: OccSavedCartAdapter,\n    },\n  ],\n})\nexport class SavedCartOccModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["pluck","CART_NORMALIZER","map","Injectable","CommonModule","provideDefaultConfig","SavedCartAdapter","NgModule"],"mappings":"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"}