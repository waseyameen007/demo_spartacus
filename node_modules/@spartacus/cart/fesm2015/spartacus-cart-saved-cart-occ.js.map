{"version":3,"file":"spartacus-cart-saved-cart-occ.js","sources":["../../../feature-libs/cart/saved-cart/occ/adapters/occ-saved-cart.adapter.ts","../../../feature-libs/cart/saved-cart/occ/model/index.ts","../../../feature-libs/cart/saved-cart/occ/config/default-occ-saved-cart-config.ts","../../../feature-libs/cart/saved-cart/occ/saved-cart-occ.module.ts","../../../feature-libs/cart/saved-cart/occ/spartacus-cart-saved-cart-occ.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { SavedCartAdapter } from '@spartacus/cart/saved-cart/core';\nimport {\n  Cart,\n  CART_NORMALIZER,\n  ConverterService,\n  Occ,\n  OccEndpointsService,\n} from '@spartacus/core';\nimport { Observable } from 'rxjs';\nimport { map, pluck } from 'rxjs/operators';\n\n@Injectable()\nexport class OccSavedCartAdapter implements SavedCartAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpoints: OccEndpointsService,\n    protected converter: ConverterService\n  ) {}\n\n  load(userId: string, cartId: string): Observable<Cart> {\n    return this.http\n      .get<Occ.Cart>(this.getSavedCartEndpoint(userId, cartId))\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  loadList(userId: string): Observable<Cart[]> {\n    return this.http\n      .get<Occ.CartList>(this.getSavedCartListEndpoint(userId))\n      .pipe(\n        pluck('carts'),\n        map((carts) => carts ?? []),\n        this.converter.pipeableMany(CART_NORMALIZER)\n      );\n  }\n\n  restoreSavedCart(userId: string, cartId: string): Observable<Cart> {\n    return this.http\n      .patch<Occ.Cart>(this.getRestoreSavedCartEndpoint(userId, cartId), cartId)\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  saveCart(\n    userId: string,\n    cartId: string,\n    saveCartName: string,\n    saveCartDescription: string\n  ): Observable<Cart> {\n    return this.http\n      .patch<Occ.Cart>(\n        this.getSaveCartEndpoint(\n          userId,\n          cartId,\n          saveCartName,\n          saveCartDescription\n        ),\n        cartId\n      )\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  cloneSavedCart(\n    userId: string,\n    cartId: string,\n    saveCartName: string\n  ): Observable<Cart> {\n    return this.http\n      .post<Occ.Cart>(\n        this.getCloneSavedCartEndpoint(userId, cartId, saveCartName),\n        cartId\n      )\n      .pipe(pluck('savedCartData'), this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  protected getSavedCartEndpoint(userId: string, cartId: string): string {\n    return this.occEndpoints.buildUrl('savedCart', {\n      urlParams: { userId, cartId },\n    });\n  }\n\n  protected getSavedCartListEndpoint(userId: string): string {\n    return this.occEndpoints.buildUrl('savedCarts', { urlParams: { userId } });\n  }\n\n  protected getRestoreSavedCartEndpoint(\n    userId: string,\n    cartId: string\n  ): string {\n    return this.occEndpoints.buildUrl('restoreSavedCart', {\n      urlParams: { userId, cartId },\n    });\n  }\n\n  protected getSaveCartEndpoint(\n    userId: string,\n    cartId: string,\n    saveCartName: string,\n    saveCartDescription: string\n  ): string {\n    return this.occEndpoints.buildUrl('saveCart', {\n      urlParams: {\n        userId,\n        cartId,\n        saveCartName,\n        saveCartDescription,\n      },\n    });\n  }\n\n  protected getCloneSavedCartEndpoint(\n    userId: string,\n    cartId: string,\n    saveCartName: string\n  ): string {\n    return this.occEndpoints.buildUrl('cloneSavedCart', {\n      urlParams: { userId, cartId, saveCartName },\n    });\n  }\n}\n","// Imported for side effects (module augmentation)\nimport './occ-saved-cart-endpoints.model';\n","import { OccConfig } from '@spartacus/core';\n\nexport const defaultOccSavedCartConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        savedCarts:\n          '/users/${userId}/carts?savedCartsOnly=true&fields=carts(DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),saveTime,user,name,description)',\n        saveCart:\n          '/users/${userId}/carts/${cartId}/save?saveCartName=${saveCartName}&saveCartDescription=${saveCartDescription}',\n        savedCart: '/users/${userId}/carts/${cartId}/savedcart',\n        restoreSavedCart: '/users/${userId}/carts/${cartId}/restoresavedcart',\n        cloneSavedCart:\n          '/users/${userId}/carts/${cartId}/clonesavedcart?name=${saveCartName}',\n      },\n    },\n  },\n};\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { SavedCartAdapter } from '@spartacus/cart/saved-cart/core';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { OccSavedCartAdapter } from './adapters/occ-saved-cart.adapter';\nimport { defaultOccSavedCartConfig } from './config/default-occ-saved-cart-config';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccSavedCartConfig),\n    {\n      provide: SavedCartAdapter,\n      useClass: OccSavedCartAdapter,\n    },\n  ],\n})\nexport class SavedCartOccModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}