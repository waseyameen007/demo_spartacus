{"version":3,"file":"spartacus-user-account-core.js","sources":["../../../feature-libs/user/account/core/connectors/converters.ts","../../../feature-libs/user/account/core/connectors/user-account.adapter.ts","../../../feature-libs/user/account/core/connectors/user-account.connector.ts","../../../feature-libs/user/account/core/facade/user-account.service.ts","../../../feature-libs/user/account/core/facade/facade-providers.ts","../../../feature-libs/user/account/core/user-account-core.module.ts","../../../feature-libs/user/account/core/spartacus-user-account-core.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\nimport { Converter } from '@spartacus/core';\nimport { User } from '@spartacus/user/account/root';\n\nexport const USER_ACCOUNT_NORMALIZER = new InjectionToken<Converter<any, User>>(\n  'UserAccountNormalizer'\n);\n\nexport const USER_ACCOUNT_SERIALIZER = new InjectionToken<Converter<User, any>>(\n  'UserAccountSerializer'\n);\n","import { Observable } from 'rxjs';\nimport { User } from '@spartacus/user/account/root';\n\nexport abstract class UserAccountAdapter {\n  abstract load(userId: string): Observable<User>;\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { User } from '@spartacus/user/account/root';\nimport { UserAccountAdapter } from './user-account.adapter';\n\n@Injectable()\nexport class UserAccountConnector {\n  constructor(protected adapter: UserAccountAdapter) {}\n\n  get(userId: string): Observable<User> {\n    return this.adapter.load(userId);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport {\n  User,\n  UserAccountChangedEvent,\n  UserAccountFacade,\n} from '@spartacus/user/account/root';\nimport {\n  LoginEvent,\n  LogoutEvent,\n  Query,\n  QueryService,\n  UserIdService,\n} from '@spartacus/core';\nimport { switchMap } from 'rxjs/operators';\nimport { UserAccountConnector } from '../connectors/user-account.connector';\n\n@Injectable()\nexport class UserAccountService implements UserAccountFacade {\n  protected userQuery: Query<User> = this.query.create(\n    () =>\n      this.userIdService\n        .takeUserId(true)\n        .pipe(switchMap((userId) => this.userAccountConnector.get(userId))),\n    {\n      reloadOn: [UserAccountChangedEvent],\n      resetOn: [LoginEvent, LogoutEvent],\n    }\n  );\n\n  constructor(\n    protected userAccountConnector: UserAccountConnector,\n    protected userIdService: UserIdService,\n    protected query: QueryService\n  ) {}\n\n  /**\n   * Returns the current user.\n   */\n  get(): Observable<User | undefined> {\n    return this.userQuery.get();\n  }\n}\n","import { UserAccountService } from './user-account.service';\nimport { UserAccountFacade } from '@spartacus/user/account/root';\nimport { Provider } from '@angular/core';\n\nexport const facadeProviders: Provider[] = [\n  UserAccountService,\n  {\n    provide: UserAccountFacade,\n    useExisting: UserAccountService,\n  },\n];\n","import { NgModule } from '@angular/core';\nimport { UserAccountConnector } from './connectors/index';\nimport { facadeProviders } from './facade/facade-providers';\n\n@NgModule({\n  providers: [UserAccountConnector, ...facadeProviders],\n})\nexport class UserAccountCoreModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":";;;;;;;MAIa,uBAAuB,GAAG,IAAI,cAAc,CACvD,uBAAuB,EACvB;MAEW,uBAAuB,GAAG,IAAI,cAAc,CACvD,uBAAuB;;MCNH,kBAAkB;;;MCG3B,oBAAoB;IAC/B,YAAsB,OAA2B;QAA3B,YAAO,GAAP,OAAO,CAAoB;KAAI;IAErD,GAAG,CAAC,MAAc;QAChB,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;KAClC;;iHALU,oBAAoB;qHAApB,oBAAoB;2FAApB,oBAAoB;kBADhC,UAAU;;;MCaE,kBAAkB;IAY7B,YACY,oBAA0C,EAC1C,aAA4B,EAC5B,KAAmB;QAFnB,yBAAoB,GAApB,oBAAoB,CAAsB;QAC1C,kBAAa,GAAb,aAAa,CAAe;QAC5B,UAAK,GAAL,KAAK,CAAc;QAdrB,cAAS,GAAgB,IAAI,CAAC,KAAK,CAAC,MAAM,CAClD,MACE,IAAI,CAAC,aAAa;aACf,UAAU,CAAC,IAAI,CAAC;aAChB,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,KAAK,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,EACvE;YACE,QAAQ,EAAE,CAAC,uBAAuB,CAAC;YACnC,OAAO,EAAE,CAAC,UAAU,EAAE,WAAW,CAAC;SACnC,CACF,CAAC;KAME;;;;IAKJ,GAAG;QACD,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC;KAC7B;;+GAvBU,kBAAkB;mHAAlB,kBAAkB;2FAAlB,kBAAkB;kBAD9B,UAAU;;;ACbJ,MAAM,eAAe,GAAe;IACzC,kBAAkB;IAClB;QACE,OAAO,EAAE,iBAAiB;QAC1B,WAAW,EAAE,kBAAkB;KAChC;CACF;;MCHY,qBAAqB;;kHAArB,qBAAqB;mHAArB,qBAAqB;mHAArB,qBAAqB,aAFrB,CAAC,oBAAoB,EAAE,GAAG,eAAe,CAAC;2FAE1C,qBAAqB;kBAHjC,QAAQ;mBAAC;oBACR,SAAS,EAAE,CAAC,oBAAoB,EAAE,GAAG,eAAe,CAAC;iBACtD;;;ACND;;;;;;"}