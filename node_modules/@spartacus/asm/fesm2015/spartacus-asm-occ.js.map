{"version":3,"file":"spartacus-asm-occ.js","sources":["../../../feature-libs/asm/occ/adapters/occ-asm.adapter.ts","../../../feature-libs/asm/occ/adapters/default-occ-asm-config.ts","../../../feature-libs/asm/occ/asm-occ.module.ts","../../../feature-libs/asm/occ/spartacus-asm-occ.ts"],"sourcesContent":["import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport {\n  AsmAdapter,\n  AsmConfig,\n  CustomerSearchOptions,\n  CustomerSearchPage,\n  CUSTOMER_SEARCH_PAGE_NORMALIZER,\n} from '@spartacus/asm/core';\nimport {\n  BaseSiteService,\n  ConverterService,\n  InterceptorUtil,\n  OccEndpointsService,\n  USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n} from '@spartacus/core';\nimport { Observable } from 'rxjs';\n\n@Injectable()\nexport class OccAsmAdapter implements AsmAdapter {\n  private activeBaseSite: string;\n\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService,\n    protected config: AsmConfig,\n    protected baseSiteService: BaseSiteService\n  ) {\n    this.baseSiteService\n      .getActive()\n      .subscribe((value) => (this.activeBaseSite = value));\n  }\n\n  customerSearch(\n    options: CustomerSearchOptions\n  ): Observable<CustomerSearchPage> {\n    const headers = InterceptorUtil.createHeader(\n      USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n      true,\n      new HttpHeaders()\n    );\n    let params: HttpParams = new HttpParams()\n      .set('baseSite', this.activeBaseSite)\n      .set('sort', 'byNameAsc');\n\n    if (typeof options['query'] !== 'undefined') {\n      params = params.set('query', '' + options.query);\n    }\n\n    if (typeof options['pageSize'] !== 'undefined') {\n      params = params.set('pageSize', '' + options.pageSize);\n    }\n\n    const url = this.occEndpointsService.buildUrl(\n      'asmCustomerSearch',\n      {},\n      {\n        baseSite: false,\n        prefix: false,\n      }\n    );\n\n    return this.http\n      .get<CustomerSearchPage>(url, { headers, params })\n      .pipe(this.converterService.pipeable(CUSTOMER_SEARCH_PAGE_NORMALIZER));\n  }\n}\n","import { OccConfig } from '@spartacus/core';\n\nexport const defaultOccAsmConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        asmCustomerSearch: '/assistedservicewebservices/customers/search',\n      },\n    },\n  },\n};\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { AsmAdapter } from '@spartacus/asm/core';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { defaultOccAsmConfig } from './adapters/default-occ-asm-config';\nimport { OccAsmAdapter } from './adapters/occ-asm.adapter';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccAsmConfig),\n    {\n      provide: AsmAdapter,\n      useClass: OccAsmAdapter,\n    },\n  ],\n})\nexport class AsmOccModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":";;;;;;;;;;MAmBa,aAAa;IAGxB,YACY,IAAgB,EAChB,mBAAwC,EACxC,gBAAkC,EAClC,MAAiB,EACjB,eAAgC;QAJhC,SAAI,GAAJ,IAAI,CAAY;QAChB,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,WAAM,GAAN,MAAM,CAAW;QACjB,oBAAe,GAAf,eAAe,CAAiB;QAE1C,IAAI,CAAC,eAAe;aACjB,SAAS,EAAE;aACX,SAAS,CAAC,CAAC,KAAK,MAAM,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC,CAAC,CAAC;KACxD;IAED,cAAc,CACZ,OAA8B;QAE9B,MAAM,OAAO,GAAG,eAAe,CAAC,YAAY,CAC1C,gCAAgC,EAChC,IAAI,EACJ,IAAI,WAAW,EAAE,CAClB,CAAC;QACF,IAAI,MAAM,GAAe,IAAI,UAAU,EAAE;aACtC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,cAAc,CAAC;aACpC,GAAG,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;QAE5B,IAAI,OAAO,OAAO,CAAC,OAAO,CAAC,KAAK,WAAW,EAAE;YAC3C,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;SAClD;QAED,IAAI,OAAO,OAAO,CAAC,UAAU,CAAC,KAAK,WAAW,EAAE;YAC9C,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;SACxD;QAED,MAAM,GAAG,GAAG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAC3C,mBAAmB,EACnB,EAAE,EACF;YACE,QAAQ,EAAE,KAAK;YACf,MAAM,EAAE,KAAK;SACd,CACF,CAAC;QAEF,OAAO,IAAI,CAAC,IAAI;aACb,GAAG,CAAqB,GAAG,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC;aACjD,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,+BAA+B,CAAC,CAAC,CAAC;KAC1E;;0GA/CU,aAAa;8GAAb,aAAa;2FAAb,aAAa;kBADzB,UAAU;;;AChBJ,MAAM,mBAAmB,GAAc;IAC5C,OAAO,EAAE;QACP,GAAG,EAAE;YACH,SAAS,EAAE;gBACT,iBAAiB,EAAE,8CAA8C;aAClE;SACF;KACF;CACF;;MCOY,YAAY;;yGAAZ,YAAY;0GAAZ,YAAY,YATb,YAAY;0GASX,YAAY,aARZ;QACT,oBAAoB,CAAC,mBAAmB,CAAC;QACzC;YACE,OAAO,EAAE,UAAU;YACnB,QAAQ,EAAE,aAAa;SACxB;KACF,YAPQ,CAAC,YAAY,CAAC;2FASZ,YAAY;kBAVxB,QAAQ;mBAAC;oBACR,OAAO,EAAE,CAAC,YAAY,CAAC;oBACvB,SAAS,EAAE;wBACT,oBAAoB,CAAC,mBAAmB,CAAC;wBACzC;4BACE,OAAO,EAAE,UAAU;4BACnB,QAAQ,EAAE,aAAa;yBACxB;qBACF;iBACF;;;AChBD;;;;;;"}