{"version":3,"file":"spartacus-asm-occ.umd.js","sources":["../../../feature-libs/asm/occ/adapters/occ-asm.adapter.ts","../../../feature-libs/asm/occ/adapters/default-occ-asm-config.ts","../../../feature-libs/asm/occ/asm-occ.module.ts","../../../feature-libs/asm/occ/spartacus-asm-occ.ts"],"sourcesContent":["import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport {\n  AsmAdapter,\n  AsmConfig,\n  CustomerSearchOptions,\n  CustomerSearchPage,\n  CUSTOMER_SEARCH_PAGE_NORMALIZER,\n} from '@spartacus/asm/core';\nimport {\n  BaseSiteService,\n  ConverterService,\n  InterceptorUtil,\n  OccEndpointsService,\n  USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n} from '@spartacus/core';\nimport { Observable } from 'rxjs';\n\n@Injectable()\nexport class OccAsmAdapter implements AsmAdapter {\n  private activeBaseSite: string;\n\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService,\n    protected config: AsmConfig,\n    protected baseSiteService: BaseSiteService\n  ) {\n    this.baseSiteService\n      .getActive()\n      .subscribe((value) => (this.activeBaseSite = value));\n  }\n\n  customerSearch(\n    options: CustomerSearchOptions\n  ): Observable<CustomerSearchPage> {\n    const headers = InterceptorUtil.createHeader(\n      USE_CUSTOMER_SUPPORT_AGENT_TOKEN,\n      true,\n      new HttpHeaders()\n    );\n    let params: HttpParams = new HttpParams()\n      .set('baseSite', this.activeBaseSite)\n      .set('sort', 'byNameAsc');\n\n    if (typeof options['query'] !== 'undefined') {\n      params = params.set('query', '' + options.query);\n    }\n\n    if (typeof options['pageSize'] !== 'undefined') {\n      params = params.set('pageSize', '' + options.pageSize);\n    }\n\n    const url = this.occEndpointsService.buildUrl(\n      'asmCustomerSearch',\n      {},\n      {\n        baseSite: false,\n        prefix: false,\n      }\n    );\n\n    return this.http\n      .get<CustomerSearchPage>(url, { headers, params })\n      .pipe(this.converterService.pipeable(CUSTOMER_SEARCH_PAGE_NORMALIZER));\n  }\n}\n","import { OccConfig } from '@spartacus/core';\n\nexport const defaultOccAsmConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        asmCustomerSearch: '/assistedservicewebservices/customers/search',\n      },\n    },\n  },\n};\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { AsmAdapter } from '@spartacus/asm/core';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { defaultOccAsmConfig } from './adapters/default-occ-asm-config';\nimport { OccAsmAdapter } from './adapters/occ-asm.adapter';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: [\n    provideDefaultConfig(defaultOccAsmConfig),\n    {\n      provide: AsmAdapter,\n      useClass: OccAsmAdapter,\n    },\n  ],\n})\nexport class AsmOccModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["InterceptorUtil","USE_CUSTOMER_SUPPORT_AGENT_TOKEN","HttpHeaders","HttpParams","CUSTOMER_SEARCH_PAGE_NORMALIZER","Injectable","CommonModule","provideDefaultConfig","AsmAdapter","NgModule"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAsBE,uBACY,IAAgB,EAChB,mBAAwC,EACxC,gBAAkC,EAClC,MAAiB,EACjB,eAAgC;YAL5C,iBAUC;YATW,SAAI,GAAJ,IAAI,CAAY;YAChB,wBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,qBAAgB,GAAhB,gBAAgB,CAAkB;YAClC,WAAM,GAAN,MAAM,CAAW;YACjB,oBAAe,GAAf,eAAe,CAAiB;YAE1C,IAAI,CAAC,eAAe;iBACjB,SAAS,EAAE;iBACX,SAAS,CAAC,UAAC,KAAK,IAAK,QAAC,KAAI,CAAC,cAAc,GAAG,KAAK,IAAC,CAAC,CAAC;SACxD;QAED,sCAAc,GAAd,UACE,OAA8B;YAE9B,IAAM,OAAO,GAAGA,kBAAe,CAAC,YAAY,CAC1CC,mCAAgC,EAChC,IAAI,EACJ,IAAIC,cAAW,EAAE,CAClB,CAAC;YACF,IAAI,MAAM,GAAe,IAAIC,aAAU,EAAE;iBACtC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,cAAc,CAAC;iBACpC,GAAG,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;YAE5B,IAAI,OAAO,OAAO,CAAC,OAAO,CAAC,KAAK,WAAW,EAAE;gBAC3C,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;aAClD;YAED,IAAI,OAAO,OAAO,CAAC,UAAU,CAAC,KAAK,WAAW,EAAE;gBAC9C,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;aACxD;YAED,IAAM,GAAG,GAAG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAC3C,mBAAmB,EACnB,EAAE,EACF;gBACE,QAAQ,EAAE,KAAK;gBACf,MAAM,EAAE,KAAK;aACd,CACF,CAAC;YAEF,OAAO,IAAI,CAAC,IAAI;iBACb,GAAG,CAAqB,GAAG,EAAE,EAAE,OAAO,SAAA,EAAE,MAAM,QAAA,EAAE,CAAC;iBACjD,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAACC,kCAA+B,CAAC,CAAC,CAAC;SAC1E;;;oIA/CU,aAAa;wIAAb,aAAa;qHAAb,aAAa;sBADzBC,aAAU;;;IChBJ,IAAM,mBAAmB,GAAc;QAC5C,OAAO,EAAE;YACP,GAAG,EAAE;gBACH,SAAS,EAAE;oBACT,iBAAiB,EAAE,8CAA8C;iBAClE;aACF;SACF;KACF;;;QCOD;;;;mIAAa,YAAY;oIAAZ,YAAY,YATbC,mBAAY;oIASX,YAAY,aARZ;YACTC,uBAAoB,CAAC,mBAAmB,CAAC;YACzC;gBACE,OAAO,EAAEC,aAAU;gBACnB,QAAQ,EAAE,aAAa;aACxB;SACF,YAPQ,CAACF,mBAAY,CAAC;qHASZ,YAAY;sBAVxBG,WAAQ;uBAAC;wBACR,OAAO,EAAE,CAACH,mBAAY,CAAC;wBACvB,SAAS,EAAE;4BACTC,uBAAoB,CAAC,mBAAmB,CAAC;4BACzC;gCACE,OAAO,EAAEC,aAAU;gCACnB,QAAQ,EAAE,aAAa;6BACxB;yBACF;qBACF;;;IChBD;;;;;;;;;;;;;"}