{"version":3,"file":"spartacus-product-variants-root.js","sources":["../../../feature-libs/product/variants/root/feature-name.ts","../../../feature-libs/product/variants/root/components/variant-style-icons/product-variant-style-icons.component.ts","../../../feature-libs/product/variants/root/components/variant-style-icons/product-variant-style-icons.component.html","../../../feature-libs/product/variants/root/components/variant-style-icons/product-variant-style-icons.module.ts","../../../feature-libs/product/variants/root/product-variants-root.module.ts","../../../feature-libs/product/variants/root/spartacus-product-variants-root.ts"],"sourcesContent":["export const PRODUCT_VARIANTS_FEATURE = 'productVariants';\n","import {\n  ChangeDetectionStrategy,\n  Component,\n  Input,\n  OnDestroy,\n  OnInit,\n  Optional,\n} from '@angular/core';\nimport {\n  OccConfig,\n  Product,\n  VariantOption,\n  VariantOptionQualifier,\n  VariantQualifier,\n} from '@spartacus/core';\nimport {\n  ProductListItemContext,\n  ProductListOutlets,\n} from '@spartacus/storefront';\nimport { EMPTY, Observable, Subscription } from 'rxjs';\n\n@Component({\n  selector: 'cx-variant-style-icons',\n  templateUrl: './product-variant-style-icons.component.html',\n  styleUrls: ['./product-variant-style-icons.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ProductVariantStyleIconsComponent implements OnInit, OnDestroy {\n  constructor(\n    private config: OccConfig,\n    @Optional()\n    protected productListItemContext?: ProductListItemContext\n  ) {}\n\n  protected subscriptions = new Subscription();\n  readonly ProductListOutlets = ProductListOutlets;\n  readonly product$: Observable<Product> =\n    this.productListItemContext?.product$ ?? EMPTY;\n\n  @Input()\n  variants: VariantOption[];\n\n  variantNames: { [key: string]: string } = {};\n\n  ngOnInit() {\n    this.setVariantsNames();\n\n    this.subscriptions.add(\n      this.product$.subscribe((product: Product) => {\n        if (product.variantOptions && product.variantOptions.length) {\n          this.variants = product.variantOptions;\n          this.setVariantsNames();\n        }\n      })\n    );\n  }\n\n  private setVariantsNames() {\n    this.variants?.forEach((variant) => {\n      if (variant.code && variant.variantOptionQualifiers) {\n        this.variantNames[variant.code] =\n          this.getVariantName(variant.variantOptionQualifiers) || '';\n      }\n    });\n  }\n\n  getVariantThumbnailUrl(\n    variantOptionQualifiers: VariantOptionQualifier[]\n  ): string {\n    const thumbnail = variantOptionQualifiers.find(\n      (item) => item.qualifier === VariantQualifier.THUMBNAIL\n    );\n    return thumbnail\n      ? `${this.config?.backend?.occ?.baseUrl}${thumbnail.image?.url}`\n      : '';\n  }\n\n  private getVariantName(\n    variantOptionQualifiers: VariantOptionQualifier[]\n  ): string | undefined {\n    const rollupProperty = variantOptionQualifiers.find(\n      (item) => item.qualifier === VariantQualifier.ROLLUP_PROPERTY\n    );\n    const property = rollupProperty\n      ? variantOptionQualifiers.find(\n          (item) => item.qualifier === rollupProperty.value\n        )\n      : null;\n    return property ? property.value : '';\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n}\n","<ul class=\"variant-list\" *ngIf=\"variants && variants.length\">\n  <li *ngFor=\"let v of variants\">\n    <img\n      [attr.src]=\"getVariantThumbnailUrl(v.variantOptionQualifiers)\"\n      [attr.title]=\"variantNames[v.code]\"\n      [attr.alt]=\"variantNames[v.code]\"\n    />\n  </li>\n</ul>\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { UrlModule, I18nModule } from '@spartacus/core';\nimport { ProductVariantStyleIconsComponent } from './product-variant-style-icons.component';\nimport { RouterModule } from '@angular/router';\n\n@NgModule({\n  imports: [CommonModule, RouterModule, UrlModule, I18nModule],\n  declarations: [ProductVariantStyleIconsComponent],\n  exports: [ProductVariantStyleIconsComponent],\n})\nexport class ProductVariantStyleIconsModule {}\n","import { NgModule } from '@angular/core';\nimport { CmsConfig, provideDefaultConfigFactory } from '@spartacus/core';\nimport { PRODUCT_VARIANTS_FEATURE } from './feature-name';\nimport {\n  ProductListOutlets,\n  OutletPosition,\n  provideOutlet,\n} from '@spartacus/storefront';\nimport { ProductVariantStyleIconsComponent } from './components/variant-style-icons/product-variant-style-icons.component';\nimport { ProductVariantStyleIconsModule } from './components/variant-style-icons/product-variant-style-icons.module';\n\n// TODO: Inline this factory when we start releasing Ivy compiled libraries\nexport function defaultProductVariantsComponentsConfig(): CmsConfig {\n  const config: CmsConfig = {\n    featureModules: {\n      [PRODUCT_VARIANTS_FEATURE]: {\n        cmsComponents: ['ProductVariantSelectorComponent'],\n      },\n    },\n  };\n\n  return config;\n}\n\n@NgModule({\n  imports: [ProductVariantStyleIconsModule],\n  providers: [\n    provideDefaultConfigFactory(defaultProductVariantsComponentsConfig),\n    provideOutlet({\n      id: ProductListOutlets.ITEM_DETAILS,\n      position: OutletPosition.AFTER,\n      component: ProductVariantStyleIconsComponent,\n    }),\n  ],\n})\nexport class ProductVariantsRootModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}