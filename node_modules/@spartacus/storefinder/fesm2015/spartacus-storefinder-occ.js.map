{"version":3,"file":"spartacus-storefinder-occ.js","sources":["../../../feature-libs/storefinder/occ/adapters/occ-store-finder.adapter.ts","../../../feature-libs/storefinder/occ/model/index.ts","../../../feature-libs/storefinder/occ/adapters/default-occ-store-finder-config.ts","../../../feature-libs/storefinder/occ/store-finder-occ.module.ts","../../../feature-libs/storefinder/occ/spartacus-storefinder-occ.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport {\n  STORE_COUNT_NORMALIZER,\n  STORE_FINDER_SEARCH_PAGE_NORMALIZER,\n  StoreCount,\n  StoreFinderAdapter,\n  StoreFinderSearchPage,\n} from '@spartacus/storefinder/core';\nimport {\n  ConverterService,\n  GeoPoint,\n  Occ,\n  OccEndpointsService,\n  POINT_OF_SERVICE_NORMALIZER,\n  PointOfService,\n  SearchConfig,\n} from '@spartacus/core';\n\n@Injectable()\nexport class OccStoreFinderAdapter implements StoreFinderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  search(\n    query: string,\n    searchConfig: SearchConfig,\n    longitudeLatitude?: GeoPoint,\n    radius?: number\n  ): Observable<StoreFinderSearchPage> {\n    return this.callOccFindStores(\n      query,\n      searchConfig,\n      longitudeLatitude,\n      radius\n    ).pipe(this.converterService.pipeable(STORE_FINDER_SEARCH_PAGE_NORMALIZER));\n  }\n\n  loadCounts(): Observable<StoreCount[]> {\n    return this.http\n      .get<Occ.StoreCountList>(\n        this.occEndpointsService.buildUrl('storescounts')\n      )\n      .pipe(\n        map(\n          ({ countriesAndRegionsStoreCount }) => countriesAndRegionsStoreCount\n        ),\n        this.converterService.pipeableMany(STORE_COUNT_NORMALIZER)\n      );\n  }\n\n  load(storeId: string): Observable<PointOfService> {\n    return this.http\n      .get<Occ.PointOfService>(\n        this.occEndpointsService.buildUrl('store', { urlParams: { storeId } })\n      )\n      .pipe(this.converterService.pipeable(POINT_OF_SERVICE_NORMALIZER));\n  }\n\n  protected callOccFindStores(\n    query: string,\n    searchConfig: SearchConfig,\n    longitudeLatitude?: GeoPoint,\n    radius?: number\n  ): Observable<Occ.StoreFinderSearchPage> {\n    const params = {};\n\n    if (longitudeLatitude) {\n      params['longitude'] = String(longitudeLatitude.longitude);\n      params['latitude'] = String(longitudeLatitude.latitude);\n      params['radius'] = String(radius);\n    } else {\n      params['query'] = query;\n    }\n\n    if (searchConfig.pageSize) {\n      params['pageSize'] = String(searchConfig.pageSize);\n    }\n    if (searchConfig.currentPage) {\n      params['currentPage'] = String(searchConfig.currentPage);\n    }\n    if (searchConfig.sort) {\n      params['sort'] = searchConfig.sort;\n    }\n\n    return this.http.get<Occ.StoreFinderSearchPage>(\n      this.occEndpointsService.buildUrl('stores', { queryParams: params })\n    );\n  }\n}\n","// Imported for side effects (module augmentation)\nimport './occ-storefinder-endpoints.model';\n","import { OccConfig } from '@spartacus/core';\n\nexport const defaultOccStoreFinderConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        store: 'stores/${storeId}?fields=FULL',\n        stores:\n          'stores?fields=stores(name,displayName,formattedDistance,openingHours(weekDayOpeningList(FULL),specialDayOpeningList(FULL)),geoPoint(latitude,longitude),address(line1,line2,town,region(FULL),postalCode,phone,country,email), features),pagination(DEFAULT),sorts(DEFAULT)',\n        storescounts: 'stores/storescounts',\n      },\n    },\n  },\n};\n","import { NgModule } from '@angular/core';\n\nimport { defaultOccStoreFinderConfig } from './adapters/default-occ-store-finder-config';\nimport { OccStoreFinderAdapter } from './adapters/occ-store-finder.adapter';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { StoreFinderAdapter } from '@spartacus/storefinder/core';\n\n@NgModule({\n  providers: [\n    provideDefaultConfig(defaultOccStoreFinderConfig),\n    { provide: StoreFinderAdapter, useClass: OccStoreFinderAdapter },\n  ],\n})\nexport class StoreFinderOccModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}