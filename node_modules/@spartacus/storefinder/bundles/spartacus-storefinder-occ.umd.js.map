{"version":3,"file":"spartacus-storefinder-occ.umd.js","sources":["../../../feature-libs/storefinder/occ/adapters/occ-store-finder.adapter.ts","../../../feature-libs/storefinder/occ/model/index.ts","../../../feature-libs/storefinder/occ/adapters/default-occ-store-finder-config.ts","../../../feature-libs/storefinder/occ/store-finder-occ.module.ts","../../../feature-libs/storefinder/occ/spartacus-storefinder-occ.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport {\n  STORE_COUNT_NORMALIZER,\n  STORE_FINDER_SEARCH_PAGE_NORMALIZER,\n  StoreCount,\n  StoreFinderAdapter,\n  StoreFinderSearchPage,\n} from '@spartacus/storefinder/core';\nimport {\n  ConverterService,\n  GeoPoint,\n  Occ,\n  OccEndpointsService,\n  POINT_OF_SERVICE_NORMALIZER,\n  PointOfService,\n  SearchConfig,\n} from '@spartacus/core';\n\n@Injectable()\nexport class OccStoreFinderAdapter implements StoreFinderAdapter {\n  constructor(\n    protected http: HttpClient,\n    protected occEndpointsService: OccEndpointsService,\n    protected converterService: ConverterService\n  ) {}\n\n  search(\n    query: string,\n    searchConfig: SearchConfig,\n    longitudeLatitude?: GeoPoint,\n    radius?: number\n  ): Observable<StoreFinderSearchPage> {\n    return this.callOccFindStores(\n      query,\n      searchConfig,\n      longitudeLatitude,\n      radius\n    ).pipe(this.converterService.pipeable(STORE_FINDER_SEARCH_PAGE_NORMALIZER));\n  }\n\n  loadCounts(): Observable<StoreCount[]> {\n    return this.http\n      .get<Occ.StoreCountList>(\n        this.occEndpointsService.buildUrl('storescounts')\n      )\n      .pipe(\n        map(\n          ({ countriesAndRegionsStoreCount }) => countriesAndRegionsStoreCount\n        ),\n        this.converterService.pipeableMany(STORE_COUNT_NORMALIZER)\n      );\n  }\n\n  load(storeId: string): Observable<PointOfService> {\n    return this.http\n      .get<Occ.PointOfService>(\n        this.occEndpointsService.buildUrl('store', { urlParams: { storeId } })\n      )\n      .pipe(this.converterService.pipeable(POINT_OF_SERVICE_NORMALIZER));\n  }\n\n  protected callOccFindStores(\n    query: string,\n    searchConfig: SearchConfig,\n    longitudeLatitude?: GeoPoint,\n    radius?: number\n  ): Observable<Occ.StoreFinderSearchPage> {\n    const params = {};\n\n    if (longitudeLatitude) {\n      params['longitude'] = String(longitudeLatitude.longitude);\n      params['latitude'] = String(longitudeLatitude.latitude);\n      params['radius'] = String(radius);\n    } else {\n      params['query'] = query;\n    }\n\n    if (searchConfig.pageSize) {\n      params['pageSize'] = String(searchConfig.pageSize);\n    }\n    if (searchConfig.currentPage) {\n      params['currentPage'] = String(searchConfig.currentPage);\n    }\n    if (searchConfig.sort) {\n      params['sort'] = searchConfig.sort;\n    }\n\n    return this.http.get<Occ.StoreFinderSearchPage>(\n      this.occEndpointsService.buildUrl('stores', { queryParams: params })\n    );\n  }\n}\n","// Imported for side effects (module augmentation)\nimport './occ-storefinder-endpoints.model';\n","import { OccConfig } from '@spartacus/core';\n\nexport const defaultOccStoreFinderConfig: OccConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        store: 'stores/${storeId}?fields=FULL',\n        stores:\n          'stores?fields=stores(name,displayName,formattedDistance,openingHours(weekDayOpeningList(FULL),specialDayOpeningList(FULL)),geoPoint(latitude,longitude),address(line1,line2,town,region(FULL),postalCode,phone,country,email), features),pagination(DEFAULT),sorts(DEFAULT)',\n        storescounts: 'stores/storescounts',\n      },\n    },\n  },\n};\n","import { NgModule } from '@angular/core';\n\nimport { defaultOccStoreFinderConfig } from './adapters/default-occ-store-finder-config';\nimport { OccStoreFinderAdapter } from './adapters/occ-store-finder.adapter';\nimport { provideDefaultConfig } from '@spartacus/core';\nimport { StoreFinderAdapter } from '@spartacus/storefinder/core';\n\n@NgModule({\n  providers: [\n    provideDefaultConfig(defaultOccStoreFinderConfig),\n    { provide: StoreFinderAdapter, useClass: OccStoreFinderAdapter },\n  ],\n})\nexport class StoreFinderOccModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["STORE_FINDER_SEARCH_PAGE_NORMALIZER","map","STORE_COUNT_NORMALIZER","POINT_OF_SERVICE_NORMALIZER","Injectable","provideDefaultConfig","StoreFinderAdapter","NgModule"],"mappings":"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"}